<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nyan Escape</title>
    <link rel="stylesheet" href="styles/main.css">

</head>
<body>
    <div id="loadingScreen">
        <img src="assets/logo.png" alt="Cyborg boot sequence" id="loadingImage">
        <div id="loadingStatus">
            <span class="loading-prefix">[SYS-BOOT:00]</span>
            <span class="loading-line">Initializing quantum cores — <span class="loading-percent">000%</span></span>
        </div>
    </div>
    <div id="backgroundContainer">
        <div class="backgroundLayer visible" id="backgroundLayerA"></div>
        <div class="backgroundLayer" id="backgroundLayerB"></div>
    </div>
    <button
        id="settingsButton"
        type="button"
        aria-haspopup="dialog"
        aria-controls="settingsDrawer"
        aria-expanded="false"
    >
        <span class="icon" aria-hidden="true">⚙</span>
        <span class="label">Settings</span>
    </button>
    <div id="gameShell">
        <div id="playfield">
            <canvas id="gameCanvas" tabindex="0" aria-label="Nyan Escape flight deck"></canvas>
            <div id="debugOverlay" aria-hidden="true" hidden>
                <div data-debug-line="logical"></div>
                <div data-debug-line="physical"></div>
                <div data-debug-line="ratio"></div>
            </div>
            <div id="survivalTimer">Flight Time: <span class="value" id="timerValue">00:00.0</span></div>
            <div id="preflightBar">
                <div id="preflightPrompt" role="status" aria-live="polite" hidden>
                    <span class="hud-title" aria-hidden="true">Nyan Ready</span>
                    <span class="prompt-text desktop-only">Press Start (Enter) to launch</span>
                    <button id="mobilePreflightButton" type="button" hidden aria-hidden="true">Tap Start</button>
                </div>
                <div id="settingsHint" aria-live="polite">
                    <span class="desktop-only">Press Esc for settings</span>
                    <span class="touch-only">Tap ⚙ for settings</span>
                </div>
            </div>
        </div>
        <aside id="instructions" aria-label="Flight telemetry, controls, and mission information">
            <nav id="instructionNav" aria-label="Quick mission links">
                <a href="#stats" data-panel-target="stats" aria-controls="stats" aria-expanded="false">Telemetry</a>
                <a href="#controlsCard" data-panel-target="controlsCard" aria-controls="controlsCard" aria-expanded="false">Controls</a>
                <a href="#missionCard" data-panel-target="missionCard" aria-controls="missionCard" aria-expanded="false">Mission</a>
                <a href="#intelCard" data-panel-target="intelCard" aria-controls="intelCard" aria-expanded="false">Intel</a>
                <a href="#socialCard" data-panel-target="socialCard" aria-controls="socialCard" aria-expanded="false">Feed</a>
            </nav>
            <div id="instructionPanels">
                <section id="stats" role="complementary" aria-live="polite">
                    <h2 class="card-title">Flight Telemetry</h2>
                    <div class="stat-list" role="presentation">
                        <div class="stat-row">
                            <span class="stat-label">Score</span>
                            <span class="value" id="score">0</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Points</span>
                            <span class="value" id="nyan">0</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Streak</span>
                            <span class="value" id="streak">x1</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Best Tail</span>
                            <span class="value" id="bestStreak">0</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">MCAP</span>
                            <span class="value" id="mcap">6.6K</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">VOL</span>
                            <span class="value" id="vol">2.8K</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Boosts</span>
                            <span class="value" id="powerUps">None</span>
                        </div>
                    </div>
                    <div
                        id="comboMeter"
                        role="progressbar"
                        aria-label="Combo charge"
                        aria-valuemin="0"
                        aria-valuemax="100"
                        aria-valuenow="0"
                    >
                        <div id="comboFill"></div>
                    </div>
                </section>
                <section class="hud-card" id="controlsCard" aria-labelledby="controlsCardTitle">
                    <h2 class="card-title" id="controlsCardTitle">Flight Controls</h2>
                    <div class="card-body">
                        <div class="control-list" role="list">
                            <div class="control-row" role="listitem">
                                <div class="control-keys" aria-label="Movement keys">
                                    <span class="keycap" aria-hidden="true">←</span>
                                    <span class="keycap" aria-hidden="true">↑</span>
                                    <span class="keycap" aria-hidden="true">↓</span>
                                    <span class="keycap" aria-hidden="true">→</span>
                                </div>
                                <div class="control-action">Vector the catship through hazards.</div>
                            </div>
                            <div class="control-row" role="listitem">
                                <div class="control-keys" aria-label="Fire control">
                                    <span class="keycap wide" aria-hidden="true">Space</span>
                                </div>
                                <div class="control-action">Launch precision plasma bolts.</div>
                            </div>
                            <div class="control-row" role="listitem">
                                <div class="control-keys" aria-label="Settings shortcut">
                                    <span class="keycap wide" aria-hidden="true">Esc</span>
                                </div>
                                <div class="control-action">Open the quick settings panel mid-flight.</div>
                            </div>
                            <div class="control-row" role="listitem">
                                <div class="control-keys" aria-label="Touch controls">
                                    <span class="keycap wide" aria-hidden="true">Touch</span>
                                </div>
                                <div class="control-action">Drag the left pad to steer, tap Fire to engage, tap ⚙ to tweak settings.</div>
                            </div>
                        </div>
                    </div>
                </section>
                <section class="hud-card" id="missionCard" aria-labelledby="missionCardTitle">
                    <h2 class="card-title" id="missionCardTitle">Mission Brief</h2>
                    <div class="card-body">
                        <ul class="mission-list">
                            <li>Collect Points to fuel the escape and grow your score.</li>
                            <li>Slip between asteroids and hostile fire to stay in the fight.</li>
                            <li>Secure booster cores for temporary firepower and agility.</li>
                            <li>Snag the Radiant Shield to ricochet villains and asteroids away.</li>
                            <li>Channel Hyper Beam cores to carve safe corridors when the lane is crowded.</li>
                            <li>Keep the combo meter charged to amplify every point.</li>
                        </ul>
                    </div>
                </section>
                <section class="hud-card" id="intelCard" aria-labelledby="intelCardTitle">
                    <h2 class="card-title" id="intelCardTitle">Tactical Intel</h2>
                    <div class="card-body">
                        <div class="challenge-section" aria-live="polite">
                            <h3>Active Challenges</h3>
                            <ul class="challenge-list" id="challengeList" role="list"></ul>
                        </div>
                        <div class="cosmetic-section" aria-live="polite">
                            <h3>Cosmetic Loadout</h3>
                            <div class="cosmetic-group" role="group" aria-label="Ship skins">
                                <span class="cosmetic-group-label">Ship</span>
                                <div class="cosmetic-options" id="skinOptions"></div>
                            </div>
                            <div class="cosmetic-group" role="group" aria-label="Trail styles">
                                <span class="cosmetic-group-label">Trail</span>
                                <div class="cosmetic-options" id="trailOptions"></div>
                            </div>
                        </div>
                        <ul class="intel-log" id="intelLog" role="list" aria-live="polite"></ul>
                    </div>
                </section>
                <section class="hud-card" id="socialCard" aria-labelledby="socialCardTitle">
                    <h2 class="card-title" id="socialCardTitle">Squadron Feed</h2>
                    <div class="card-body">
                        <ul id="socialFeed" role="list"></ul>
                    </div>
                </section>
            </div>
        </aside>
    </div>
    <div id="touchControls" aria-hidden="true">
        <div id="joystickZone">
            <div class="joystick-ring"></div>
            <div class="joystick-thumb"></div>
        </div>
        <button id="fireButton" type="button" aria-label="Fire cosmic arrows">Fire</button>
    </div>
    <div id="overlay">
        <div class="overlay-content">
            <h1>NYAN DASH</h1>
            <div id="comicIntro" class="comic-panels" hidden>
            <article class="comic-panel">
                <h3>Inciting Incident</h3>
                <p>Space Station Meowprise is under siege by neon asteroids. Only your star-kitted reflexes can cut a path to safety.</p>
            </article>
            <article class="comic-panel">
                <h3>Assemble the Crew</h3>
                <p>Power cores, Nova Pulses, and the Radiant Shield await. Stack boosts, chain streaks, and bend the odds in your favor.</p>
            </article>
            <article class="comic-panel">
                <h3>Broadcast the Escape</h3>
                <p>Every logged flight inspires the squadron. Chronicle your best three runs each cycle and rally the galaxy.</p>
            </article>
        </div>
            <p id="overlayMessage">Thread the cosmic needle, gather Points, and charge Nova Pulses to vaporize space junk. Ready to glide?</p>
            <form id="callsignForm" autocomplete="off" novalidate>
                <label for="playerNameInput">Pilot Callsign</label>
                <div class="input-row">
                    <input id="playerNameInput" name="playerName" type="text" maxlength="24" autocomplete="off" spellcheck="false" placeholder="Ace Pilot" aria-describedby="callsignHint">
                    <span id="callsignHint">Confirm your callsign, then press Start (Enter) to launch.</span>
                </div>
            </form>
            <div id="overlayActions">
                <button id="overlayButton" type="button" disabled aria-disabled="true">Confirm Callsign</button>
                <button id="overlaySecondaryButton" type="button" class="secondary" hidden aria-disabled="true">Skip Submission</button>
                <button id="swapPilotButton" type="button" class="tertiary">Swap Pilot</button>
            </div>
            <div id="pilotPreview" aria-live="polite">
                <div class="pilot-preview-header">
                    <h2>Pilot Loadouts</h2>
                    <p id="pilotPreviewDescription">Each pilot tweaks the ship's handling. Compare at a glance, then open the hangar to inspect full specs.</p>
                </div>
                <div id="pilotPreviewGrid" class="pilot-preview-grid" role="list"></div>
            </div>
            <div id="overlayPanels">
                <article id="summaryCard" class="summary-card" aria-label="Flight summary">
                    <header class="summary-card-header">
                        <h2 class="summary-card-title">Flight Debrief</h2>
                        <div class="summary-tabs" role="tablist" aria-label="Debrief categories">
                            <button
                                type="button"
                                class="summary-tab active"
                                id="summaryTab-run"
                                data-summary-tab="run"
                                aria-selected="true"
                                aria-controls="summarySectionRun"
                                role="tab"
                            >
                                Your run
                            </button>
                            <button
                                type="button"
                                class="summary-tab"
                                id="summaryTab-rank"
                                data-summary-tab="rank"
                                aria-selected="false"
                                aria-controls="summarySectionRank"
                                role="tab"
                                tabindex="-1"
                            >
                                Global rank
                            </button>
                            <button
                                type="button"
                                class="summary-tab"
                                id="summaryTab-share"
                                data-summary-tab="share"
                                aria-selected="false"
                                aria-controls="summarySectionShare"
                                role="tab"
                                tabindex="-1"
                            >
                                Share
                            </button>
                        </div>
                    </header>
                    <div class="summary-body">
                        <section
                            id="summarySectionRun"
                            class="summary-section active"
                            data-summary-section="run"
                            role="tabpanel"
                            aria-labelledby="summaryTab-run"
                        >
                            <header class="summary-section-header">
                                <h3>Your run</h3>
                                <p id="runSummaryStatus" class="summary-status" role="status" aria-live="polite"></p>
                            </header>
                            <div class="run-summary-grid" role="list">
                                <div class="run-summary-metric" role="listitem">
                                    <span class="label">Flight time</span>
                                    <span class="value" id="runSummaryTime">&mdash;</span>
                                </div>
                                <div class="run-summary-metric" role="listitem">
                                    <span class="label">Score</span>
                                    <span class="value" id="runSummaryScore">&mdash;</span>
                                </div>
                                <div class="run-summary-metric" role="listitem">
                                    <span class="label">Best tail</span>
                                    <span class="value" id="runSummaryStreak">&mdash;</span>
                                </div>
                                <div class="run-summary-metric" role="listitem">
                                    <span class="label">Pickups</span>
                                    <span class="value" id="runSummaryNyan">&mdash;</span>
                                </div>
                            </div>
                            <div class="run-summary-meta">
                                <span id="runSummaryPlacement" class="meta-item"></span>
                                <span id="runSummaryRuns" class="meta-item"></span>
                            </div>
                            <div id="highScorePanel" class="summary-subpanel" aria-live="polite">
                                <div id="highScoreTitle" class="summary-subtitle">Top Flight Times</div>
                                <ol id="highScoreList"></ol>
                            </div>
                        </section>
                        <section
                            id="summarySectionRank"
                            class="summary-section"
                            data-summary-section="rank"
                            role="tabpanel"
                            aria-labelledby="summaryTab-rank"
                            hidden
                        >
                            <div id="leaderboardPanel" class="summary-subpanel">
                                <div class="panel-header">
                                    <div class="panel-title" id="leaderboardTitle">Galaxy Standings</div>
                                    <div class="panel-tabs" role="tablist" aria-label="Leaderboard scope">
                                        <button
                                            type="button"
                                            class="leaderboard-tab active"
                                            data-leaderboard-scope="global"
                                            aria-pressed="true"
                                        >
                                            Global
                                        </button>
                                        <button
                                            type="button"
                                            class="leaderboard-tab"
                                            data-leaderboard-scope="weekly"
                                            aria-pressed="false"
                                        >
                                            Weekly
                                        </button>
                                    </div>
                                </div>
                                <p
                                    id="leaderboardStatus"
                                    class="panel-status"
                                    role="status"
                                    aria-live="polite"
                                    hidden
                                ></p>
                                <ol id="leaderboardList"></ol>
                            </div>
                        </section>
                        <section
                            id="summarySectionShare"
                            class="summary-section"
                            data-summary-section="share"
                            role="tabpanel"
                            aria-labelledby="summaryTab-share"
                            hidden
                        >
                            <div id="sharePanel" class="summary-subpanel">
                                <div class="panel-title">Broadcast Run</div>
                                <div class="share-buttons">
                                    <button id="shareButton" class="share-button" type="button">Share Flight Log</button>
                                </div>
                                <p id="shareStatus" role="status" aria-live="polite"></p>
                            </div>
                        </section>
                    </div>
                </article>
            </div>
        </div>
    </div>
    <div id="characterSelectModal" hidden aria-hidden="true">
        <div class="character-select-backdrop" aria-hidden="true"></div>
        <div
            class="character-select-content"
            role="dialog"
            aria-modal="true"
            aria-labelledby="characterSelectTitle"
        >
            <h2 id="characterSelectTitle">Select Your Pilot</h2>
            <div id="characterSelectSummary" aria-live="polite">
                <p class="character-summary-description" data-character-summary-description>
                    Each pilot tunes the starfighter differently. Hover or focus to reveal their loadout, then lock in
                    the approach that fits this run.
                </p>
                <ul class="character-summary-ongoing" data-character-summary-ongoing hidden></ul>
            </div>
            <div class="character-grid" role="list" data-character-grid></div>
            <div class="character-select-actions">
                <button id="characterSelectConfirm" type="button" disabled aria-disabled="true">
                    Select a Pilot
                </button>
                <button id="characterSelectCancel" type="button" class="secondary">Back</button>
            </div>
        </div>
    </div>
    <div
        id="settingsDrawer"
        role="dialog"
        aria-modal="true"
        aria-labelledby="settingsTitle"
        aria-hidden="true"
        hidden
    >
        <div class="settings-backdrop" data-settings-dismiss="backdrop"></div>
        <div class="settings-content" role="document">
            <button id="settingsCloseButton" type="button">Close</button>
            <h2 id="settingsTitle">Flight Settings</h2>
            <div class="settings-group" role="group" aria-labelledby="settingsTitle">
                <div class="settings-row">
                    <div class="setting-label">
                        Master Volume
                        <span>Overall output</span>
                    </div>
                    <input
                        id="masterVolumeSlider"
                        type="range"
                        min="0"
                        max="100"
                        value="85"
                        aria-valuemin="0"
                        aria-valuemax="100"
                        aria-valuenow="85"
                        aria-label="Master volume"
                    />
                    <output id="masterVolumeValue" for="masterVolumeSlider">85%</output>
                </div>
                <div class="settings-row">
                    <div class="setting-label">
                        Music Track
                        <span>Background score</span>
                    </div>
                    <label class="settings-toggle" for="musicToggle">
                        <input id="musicToggle" type="checkbox" checked />
                        <span id="musicToggleStatus" class="toggle-status">On</span>
                    </label>
                </div>
                <div class="settings-row">
                    <div class="setting-label">
                        Effects Audio
                        <span>Projectiles &amp; bursts</span>
                    </div>
                    <label class="settings-toggle" for="sfxToggle">
                        <input id="sfxToggle" type="checkbox" checked />
                        <span id="sfxToggleStatus" class="toggle-status">On</span>
                    </label>
                </div>
                <div class="settings-row">
                    <div class="setting-label">
                        Reduced Effects
                        <span>Dim particle storms</span>
                    </div>
                    <label class="settings-toggle" for="reducedEffectsToggle">
                        <input id="reducedEffectsToggle" type="checkbox" />
                        <span id="reducedEffectsStatus" class="toggle-status">Off</span>
                    </label>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="scripts/app.js"></script>

</body>
</html>
